!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.componentDragLib=t():e.componentDragLib=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};let o,n,r,a,s;e.r(t),e.d(t,{componentDrag:()=>i});function i({parentCtr:e=document.body,controls:t,dragClass:i="drag-handle",sortClass:l="sort-ctr"}){e.style.position="relative",e.style.boxSizing="content-box";let c=[];function p(c){!function({parentCtr:e,component:t,dragHandle:i,sortctrs:l,snapStep:c,gridSnap:p,alignSnap:d,collisionSnap:f,magStr:g}){t.parentNode==e&&(t.style.position="absolute"),(i=i||t).draggable=!0;const y={x:void 0,y:void 0},u={x:void 0,y:void 0};function m(i){i.stopPropagation();const l=document.createElement("span");i.dataTransfer.setDragImage(l,0,0),((e,t,i,l)=>{((e,t)=>{const o=(e,t)=>parseInt(window.getComputedStyle(e).getPropertyValue(t));n=o(e,"padding-left"),r=o(e,"width")-t.offsetWidth+n,a=o(e,"padding-top"),s=o(e,"height")-t.offsetHeight+a})(e,t),((e,t,n,r)=>{null!=n&&null!=r&&1!=n.checked&&1!=r.checked||(o={magL:[],magR:[],magT:[],magB:[]},Array.from(e.children).filter((e=>e!=t)).forEach((e=>{const t=e.offsetLeft,n=t+e.offsetWidth,r=e.offsetTop,a=r+e.offsetHeight;o.magL.push(t),o.magR.push(n),o.magT.push(r),o.magB.push(a)})))})(e,t,i,l)})(e,t,d,f);const c=t.getBoundingClientRect(),p=c.x-e.offsetLeft-e.clientLeft,g=c.y-e.offsetTop-e.clientTop;y.x=i.clientX-p-window.scrollX,y.y=i.clientY-g-window.scrollY,t.classList.add("dragging"),t.parentNode!=e&&(t.style.left=i.clientX-y.x+"px",t.style.top=i.clientY-y.y+"px")}function h(e){e.preventDefault(),e.stopPropagation(),0!=e.clientX&&(u.x=e.clientX-y.x,u.y=e.clientY-y.y,((e,t,i,l,c,p,d)=>{((e,t,o)=>{if(null==o||1==o.checked){t=t?parseInt(t.value):25;const o=e=>Math.round(e/t)*t;e.x=o(e.x),e.y=o(e.y)}})(e,t,i),(e=>{const t=(e,t,o)=>Math.min(Math.max(e,t),o);e.x=t(e.x,n,r),e.y=t(e.y,a,s)})(e),((e,t,n,r,a)=>{a=a?parseInt(a.value):8;const s=e.x+t.offsetWidth,i=e.y+t.offsetHeight,l=(e,t)=>o[e].find((e=>t>e-a&&t<e+a));null!=n&&1!=n.checked||(e.x=l("magL",e.x)||l("magR",s)-t.offsetWidth||e.x,e.y=l("magT",e.y)||l("magB",i)-t.offsetHeight||e.y),null!=r&&1!=r.checked||(e.x=l("magR",e.x)||l("magL",s)-t.offsetWidth||e.x,e.y=l("magB",e.y)||l("magT",i)-t.offsetHeight||e.y)})(e,l,c,p,d)})(u,c,p,t,d,f,g),t.style.left=u.x+"px",t.style.top=u.y+"px",t.style.zIndex="10",t.style.pointerEvents="none",t.style.filter="brightness(1.4)")}e.ondragover=t=>{!function(t){t.preventDefault();const o=document.querySelector(".dragging");o.parentNode!=e&&(o.style.position="absolute",e.append(o))}(t)},i.ondragstart=e=>{m(e)},i.ondrag=e=>{h(e)},i.ondragend=e=>{y.x=y.y=0,t.classList.remove("dragging"),t.style.removeProperty("z-index"),t.style.removeProperty("pointer-events"),t.style.removeProperty("filter")},(e=>{(e=>{e.forEach((e=>{e.ondragover=t=>{!function(e,t){e.preventDefault(),e.stopPropagation();const o=function(e,t){return[...e.querySelectorAll(":scope > :not(.dragging)")].reduce(((e,o)=>{const n=o.getBoundingClientRect(),r=t-n.top-n.height/2;return r<0&&r>e.offset?{offset:r,element:o}:e}),{offset:Number.NEGATIVE_INFINITY}).element}(t,e.clientY),n=document.querySelector(".dragging");n.style.position="static",t.insertBefore(n,o)}(t,e)}}))})(e)})(l)}({parentCtr:e,component:c,dragHandle:c.querySelector(`:scope > .${i}`),sortctrs:c.querySelectorAll(`.${l}`),snapStep:t?.snapstep,magStr:t?.magstr,gridSnap:t?.gridsnap,alignSnap:t?.alignsnap,collisionSnap:t?.collisionsnap})}Array.from(e.children).forEach((e=>{p(e),c.push(e)})),e.querySelectorAll(`.${l}`).forEach((e=>Array.from(e.children).forEach((e=>{p(e),c.push(e)})))),new MutationObserver((e=>{e[0].addedNodes.forEach((e=>{c.includes(e)||(p(e),c.push(e))}))})).observe(e,{childList:!0})}return t})()));